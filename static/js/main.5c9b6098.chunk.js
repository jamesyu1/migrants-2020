(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{125:function(t,e,n){"use strict";n.r(e);var c=n(3),a=n(0),r=n(2),i=n(40),s=n.n(i),o=n(1),j=n(17),l=function(t){return t.coords=t["Location Coordinates"].split(",").map((function(t){return+t})).reverse(),t["Total Dead and Missing"]=+t["Total Dead and Missing"],t["Reported Date"]=new Date(t["Reported Date"]),t},u=Object(o.f)(),d=Object(o.e)(),b=function(t){var e=t.worldAtlas,n=e.land,i=e.interiors,s=t.data,j=t.width,l=t.height,b=t.sizeScale,h=t.sizeValue,O=Object(o.g)(u.fitSize([j,l],n));return Object(a.jsxs)("g",{className:"marks",children:[Object(r.useMemo)((function(){return console.log("rendering map"),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("path",{className:"sphere",d:O({type:"Sphere"})}),Object(a.jsx)("path",{className:"graticules",d:O(d())}),n.features.map((function(t){return Object(a.jsx)("path",{className:"land",d:O(t)})})),Object(a.jsx)("path",{className:"interiors",d:O(i)})]})}),[d,n,i]),s.map((function(t){var e=u(t.coords),n=Object(c.a)(e,2),r=n[0],i=n[1];return Object(a.jsx)("circle",{cx:r,cy:i,r:b(h(t))})}))]})},h=function(t){return t["Total Dead and Missing"]},O=function(t){var e=t.data,n=t.filteredData,c=t.worldAtlas,i=t.width,s=t.height,j=Object(r.useMemo)((function(){return Object(o.k)().domain([0,Object(o.i)(e,h)]).range([0,15])}),[e,h,15]);return Object(a.jsx)(b,{worldAtlas:c,data:n,width:i,height:s,sizeScale:j,sizeValue:h})},f=function(t){var e=t.xScale,n=t.innerHeight,c=t.tickFormat,r=t.tickOffset,i=void 0===r?3:r;return e.ticks().map((function(t){return Object(a.jsxs)("g",{className:"tick",transform:"translate(".concat(e(t),", 0)"),children:[Object(a.jsx)("line",{x1:0,y1:0,x2:0,y2:n}),Object(a.jsx)("text",{dy:".71em",style:{textAnchor:"middle"},y:n+i,children:c(t)})]},t)}))},x=function(t){var e=t.yScale,n=t.innerWidth,c=t.tickOffset,r=void 0===c?3:c;return e.ticks().map((function(t){return Object(a.jsxs)("g",{className:"tick",transform:"translate(0, ".concat(e(t),")"),children:[Object(a.jsx)("line",{x1:0,y1:0,x2:n,y2:0}),Object(a.jsx)("text",{dy:".42em",x:-r,style:{textAnchor:"end"},children:t})]},t)}))},m=function(t){var e=t.binnedData,n=t.xScale,c=t.yScale,r=t.tooltipFormat,i=t.innerHeight;return e.map((function(t){return Object(a.jsx)("g",{className:"marks",children:Object(a.jsx)("rect",{x:n(t.x0),y:c(t.y),width:n(t.x1)-n(t.x0),height:i-c(t.y),children:Object(a.jsx)("title",{children:r(t.y)})})})}))},g=0,p=20,y=50,v=30,w=Object(o.o)("%Y-%m-%d"),k=function(t){return t["Total Dead and Missing"]},S=function(t){var e=t.data,n=t.width,i=t.height,s=t.setBrushExtent,j=t.xValue,l=i-g-p,u=n-y-v,d=Object(r.useMemo)((function(){return Object(o.l)().domain(Object(o.d)(e,j)).range([0,u]).nice()}),[e,j,u]),b=Object(r.useMemo)((function(){var t=d.domain(),n=Object(c.a)(t,2),a=n[0],r=n[1];return Object(o.a)().value(j).domain(d.domain()).thresholds(Object(o.p)(a,r))(e).map((function(t){return{x0:t.x0,x1:t.x1,y:Object(o.n)(t,k)}}))}),[j,d,e,k]),h=Object(r.useMemo)((function(){return Object(o.j)().domain([0,Object(o.i)(b,(function(t){return t.y}))]).range([l,0]).nice()}),[b,l]),O=Object(r.useRef)();return Object(r.useEffect)((function(){var t=Object(o.b)().extent([[0,0],[u,l]]);t(Object(o.m)(O.current)),t.on("brush end",(function(t){s(t.selection?t.selection.map(d.invert):null)}))}),[u,l]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("rect",{width:n,height:i,fill:"white"}),Object(a.jsxs)("g",{transform:"translate(".concat(y,", ").concat(g,")"),children:[Object(a.jsx)(f,{xScale:d,innerHeight:l,tickFormat:w,tickOffset:8}),Object(a.jsx)(x,{yScale:h,innerWidth:u,tickOffset:8}),Object(a.jsx)(m,{binnedData:b,xScale:d,yScale:h,tooltipFormat:function(t){return t},innerHeight:l}),Object(a.jsx)("text",{className:"axis-label",x:u/2,y:l+50,textAnchor:"middle",children:"Date"}),Object(a.jsx)("text",{className:"axis-label",textAnchor:"middle",transform:"translate(".concat(-35,", ").concat(l/2,") rotate(-90)"),children:"Total Dead and Missing"}),Object(a.jsx)("g",{ref:O})]})]})},D=window.innerWidth,M=window.innerHeight,N=function(t){return t["Reported Date"]},A=function(){var t=function(){var t=Object(r.useState)(null),e=Object(c.a)(t,2),n=e[0],a=e[1];return Object(r.useEffect)((function(){Object(o.h)("https://unpkg.com/world-atlas@2.0.2/countries-50m.json").then((function(t){var e=t.objects,n=e.countries,c=e.land;a({land:Object(j.a)(t,c),interiors:Object(j.b)(t,n,(function(t,e){return t!==e}))})}))}),[]),n}(),e=function(){var t=Object(r.useState)(null),e=Object(c.a)(t,2),n=e[0],a=e[1];return Object(r.useEffect)((function(){Object(o.c)("https://gist.githubusercontent.com/curran/a9656d711a8ad31d812b8f9963ac441c/raw/c22144062566de911ba32509613c84af2a99e8e2/MissingMigrants-Global-2019-10-08T09-47-14-subset.csv",l).then(a)}),[]),n}(),n=Object(r.useState)(),i=Object(c.a)(n,2),s=i[0],u=i[1];if(!t||!e)return Object(a.jsx)("pre",{children:"Loading..."});var d=s?e.filter((function(t){var e=N(t);return e>s[0]&&e<s[1]})):e;return Object(a.jsxs)("svg",{width:D,height:M,children:[Object(a.jsx)(O,{data:e,filteredData:d,worldAtlas:t,width:D,height:M}),Object(a.jsx)("g",{transform:"translate(0, ".concat(M-.25*M,")"),children:Object(a.jsx)(S,{data:e,width:D,height:.25*M,setBrushExtent:u,xValue:N})})]})},E=document.getElementById("root");s.a.render(Object(a.jsx)(A,{}),E)}},[[125,1,2]]]);
//# sourceMappingURL=main.5c9b6098.chunk.js.map